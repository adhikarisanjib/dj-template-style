<nav class="px-6 py-2 flex text-gray-900 bg-gray-50 dark:text-gray-100 dark:bg-gray-700">

    <!-- Desktop -->
    <div class="hidden lg:flex flex-grow justify-between items-center">
        <div class="flex">
            <a href="#">Home</a>
        </div>
        <div class="flex space-x-2">
            <button id="id-desktop-theme-toggler" class="p-2 flex items-center hover:bg-gray-200 hover:dark:bg-gray-800"></button>
            <button class="px-3 py-2 hover:bg-gray-200 hover:dark:bg-gray-800">Logout</button>
            <button class="px-3 py-2 hover:bg-gray-200 hover:dark:bg-gray-800">Profile</button>
        </div>
    </div>

    <!-- Mobile -->
    <div class="flex flex-col flex-grow lg:hidden">
        <div class="ml-auto flex space-x-2">
            <button id="id-mobile-theme-toggler" class="p-2 hover:bg-gray-200 hover:dark:bg-gray-800"></button>
            <button id="id-navbar-toggler" class="p-2 hover:bg-gray-200 hover:dark:bg-gray-800"><i class="bx bx-menu text-2xl"></i></button>
        </div>
        <div id="id-navbar-items" class="mt-3 py-2 border-t flex-col justify-center hidden">
            <button class="px-3 py-2 hover:bg-gray-200 hover:dark:bg-gray-800">Logout</button>
            <button class="px-3 py-2 hover:bg-gray-200 hover:dark:bg-gray-800">Profile</button>
        </div>
    </div>
</nav>

<script>
    // Retrieve theme from localStorage or fallback to system default
    let theme = localStorage.getItem("theme");
    let navbarToggler = document.getElementById("id-navbar-toggler");
    let desktopThemeToggler = document.getElementById("id-desktop-theme-toggler");
    let mobileThemeToggler = document.getElementById("id-mobile-theme-toggler");

    if (theme == null) {
        // Check system preference
        const prefersDark = window.matchMedia("(prefers-color-scheme: dark)").matches;
        theme = prefersDark ? "dark" : "light";
        localStorage.setItem("theme", theme);
    }

    // Apply the theme
    document.addEventListener("DOMContentLoaded", function () {
        if (theme === "dark") {
            document.documentElement.classList.add("dark");
            desktopThemeToggler.innerHTML = "<i class='bx bx-sun text-xl'></i>";
            mobileThemeToggler.innerHTML = "<i class='bx bx-sun text-xl'></i>";
        } else {
            document.documentElement.classList.remove("dark");
            desktopThemeToggler.innerHTML = "<i class='bx bx-moon text-lg'></i>";
            mobileThemeToggler.innerHTML = "<i class='bx bx-moon text-lg'></i>";
        }
    });

    // Function to toggle theme
    function toggleTheme(themeToggler) {
        let currentTheme = localStorage.getItem("theme");
        if (currentTheme === "dark") {
            document.documentElement.classList.remove("dark");
            localStorage.setItem("theme", "light");
            themeToggler.innerHTML = "<i class='bx bx-moon text-lg'></i>";
        } else {
            document.documentElement.classList.add("dark");
            localStorage.setItem("theme", "dark");
            themeToggler.innerHTML = "<i class='bx bx-sun text-xl'></i>";
        }
    }

    // Add event listeners to toggle buttons
    desktopThemeToggler.addEventListener("click", function (e) {
        e.preventDefault();
        toggleTheme(desktopThemeToggler);
    });

    mobileThemeToggler.addEventListener("click", function (e) {
        e.preventDefault();
        toggleTheme(mobileThemeToggler);
    });

    navbarToggler.addEventListener("click", function (e) {
        e.preventDefault();
        let navbarItems = document.getElementById("id-navbar-items");
        navbarItems.classList.toggle("hidden");
        navbarItems.classList.toggle("flex");
    });
</script>
